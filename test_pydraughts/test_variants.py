import draughts
from draughts import Game, Move
from draughts.convert import move_from_variant


def play_game(moves, variant):
    game = Game(variant)
    for move in moves:
        assert game.get_winner() is None
        game.push(Move(pdn_move=move_from_variant(move, variant=game.variant), board=game).board_move)
    game.get_winner()
    return game


def test_variants():
    # Standard
    standard_moves = '32-28 17-21 34-29 21-26 40-34 16-21 37-32 26x37 42x31 21-26 47-42 26x37 42x31 11-17 44-40 6-11 41-37 17-21 31-26 21-27 32x21 18-23 29x18 12x41 46x37 13-18 38-32 9-13 43-38 19-23 49-43 14-19 34-29 23x34 39x30 20-25 50-44 25x34 40x29 10-14 33-28 7-12 21-16 2-7 28-23 19x28 32x23 14-20 29-24 20x29 23x34 5-10 37-32 15-20 44-39 13-19 36-31 11-17 38-33 8-13 45-40 19-24 43-38 13-19 32-28 18-23 28-22 17x28 33x22 20-25 48-42 12-18 22x13 19x8 39-33 10-14 33-29 24x33 38x18 4-9 42-38 14-19 38-33 19-24 26-21 8-13 18-12 7x18 34-29 18-22 29x20 25x14 16-11 13-18 40-34 9-13 33-29 14-19 21-16 22-27 31x22 18x27 34-30 27-32 29-24 32-37 24-20 37-41 20-15 41-46 15-10 19-24 30x8 3x12 10-4 1-6 4-13 6x17 35-30 46-41 30-25 41-47 13-27 17-21 16-11 21x32 11-6 47-15 6-1 12-17 25-20 15x24 1-40 17-22 40-35 24-29 35-13 22-27 13x31 32-38 31-27 38-42 27-32 42-48 32-28 48-34 28-19 34-25 19-28'.split()
    play_game(standard_moves, 'standard')
    # Frisian
    frisian_moves = '32-27 19-23 27-21 17x26 31-27 26x28 33x24 20x29 39x17 12x21 34-30 21-26 30-25 13-18 38-32 8-12 40-34 12-17 34-30 7-12 43-38 14-20 25x14 9x40 45x34 17-21 34-30 18-22 30-25 12-17 32x12 17x8 38-33 21-27 37x17 11x22 33-29 22-27 29-24 2-7 42-37 16-21 36x16 6x26 37x17 21x12 41-36 1-6 36x16 6x26 46-41 12-17 41-37 17-22 37-32 22x42 48x37 8-12 50-45 3-9 44-39 10-14 24-20 15x24 25x23 14-20 49-44 12-17 44-40 17-22 23x21 26x17 39-34 17-21 37-31 21x41 47x36 4-10 34-30 9-13 30-25 7-12 25x14 10x19 35-30 19-23 36-31 12-17 30-25 23-29 40-34 29x40 45x34 5-10 34-29 10-14 29-24 14x34 25-20 34-40 20-15 40-45 15-10 13-19 10-5 19-24 5-32 24-29 32-49 29-33 49-43 17-21 43x26 45-50 31-27 50-39 26-48 39-50 48-37 50-44 37-19 44-49'.split()
    game = play_game(frisian_moves, 'frisian')
    assert game.legal_moves() == ([[[27, 21]], [[27, 22]]], [[None], [None]])
    # Frysk!
    frysk_moves = '48-43 1-7 43-39 7-11 46-41 11-17 41-37 17-21 37-31 21x41 47x36 5-10 36-31 3-8 49-44 10-14 44-40 8-12 40-35 14-20 39-33 20-24 50-45 4-9 33-28 2-8 28-22 12x32 31x33 8-12 35-30 24x35 45x25 9-14 33-28 12-17 28-23 17-21 23-18 21-27 18-12 27-31 12-7 31-37 7-1 37-42 1-18 42-47 18-4 47-36 4x34 36-41 25-20 41-10 20-15 10-19 34-12 19-28 12-34 28-19 15-10 19x5 34-18 5-14 18-22 14-10'.split()
    play_game(frysk_moves, 'frysk')
    # Antidraughts
    antidraughts_moves = '35-30 16-21 31-27 20-24 27x16 24x35 36-31 15-20 31-26 20-25 41-36 17-21 16x27 10-15 33-28 18-22 27x18 13x33 38x29 12-18 29-24 19x30 32-27 18-22 27x18 5-10 43-38 8-12 18-13 9x18 36-31 18-22 49-43 22-27 31x22 12-18 22x13 14-19 13x24 30x19 34-29 11-17 26-21 17x26 29-24 19x30 37-32 6-11 46-41 7-12 38-33 30-34 40x29 12-17 45-40 2-8 50-45 15-20 41-36 1-7 36-31 26x28 33x22 17x28 39-33 28x50 42-37 35x44 37-31 8-12 29-24 20x29 45-40 44x35 43-39 50x36 47-41 36x47 48-42 47x33'.split()
    game = play_game(antidraughts_moves, 'antidraughts')
    assert game.get_winner() == draughts.WHITE
    # Breakthrough
    breakthrough_moves = '32-28 19-24 37-32 17-21 34-29 21-26 39-34 26x37 42x31 18-22 28x17 11x22 44-39 12-18 47-42 14-19 50-44 10-14 41-37 7-12 34-30 4-10 46-41 1-7 30-25 19-23 40-34 14-19 25x14 9x20 32-28 23x32 37x17 12x21 34-30 21-26 41-37 20-25 29x20 25x34 39x30 15x24 45-40 16-21 38-32 6-11 43-38 11-16 49-43 7-12 40-34 3-9 43-39 10-14 33-29 24x33 38x29 2-7 30-24 19x30 35x24 5-10 42-38 18-22 34-30 21-27 32x21 16x27 29-23 10-15 30-25 27-32 38x18 13x22 48-42 22-28 23x32 8-13 39-33 14-19 33-28 19x30 25x34 7-11 31-27 9-14 34-29 14-20 29-23 20-25 27-22 12-17 22-18 13x33 23-19 26-31 37x26 33-39 44x33 17-22 19-13 25-30 13-9 22-27 32x21 11-17 21x12 15-20 9-4'.split()
    play_game(breakthrough_moves, 'breakthrough')
    # Russian
    russian_moves = 'a3-b4 b6-a5 g3-f4 d6-e5 f4xd6 e7xa3 e3-d4 c7-d6 c3-b4 a5xe5 h2-g3 f6-g5 g3-h4 g5-f4 f2-g3 f4xh2 d2-c3 a7-b6 c3-b4 a3xc5 g1-f2 h6-g5 h4xd4 c5xg1 e1-f2 g1xe3 c1-d2 e3xa3 a1-b2 a3xc1'.split()
    play_game(russian_moves, 'russian')
    # Brazilian
    brazilian_moves = 'g3-f4 d6-e5 f4xd6 c7xe5 a3-b4 e7-d6 b4-a5 b8-c7 c3-d4 e5xc3 b2xd4 b6-c5 d4xb6 a7xc5 h2-g3 f6-e5 g3-f4 e5xg3 f2xh4 h6-g5 h4xf6 g7xe5 a5-b6 c7xa5 c1-b2 d8-e7 b2-a3 f8-g7 a3-b4 a5xc3 d2xb4 c5xa3 g1-f2 e5-d4 e3xc5 d6xb4 f2-g3 g7-f6 e1-d2 f6-e5 a1-b2 a3xe3 g3-f4'.split()
    play_game(brazilian_moves, 'brazilian')
    # English/American
    english_moves = '11-15 23-18 8-11 27-23 4-8 23-19 10-14 19x10 14x23 26x19 7x14 24-20 6-10 22-17 9-13 30-26 13x22 25x9 5x14 29-25 14-18 26-23 18x27 32x23 11-15 28-24 2-6 21-17 8-11 25-22 6-9 23-18 1-5 17-13 9-14 18x9 5x14 13-9 14-18 22-17 18-23 9-6 15-18 6-2 18-22 2-6 3-8 6x15 11x18 19-15 22-26 31x22 18x25 24-19 23-27 20-16 27-31 16-11 31-27 11x4 27-23'.split()
    play_game(english_moves, 'american')
    # Italian
    italian_moves = '21-17 12-15 23-19 11-14 19x12 8x15 28-23 14-18 22x13 9x18 23-20 10-14 20x11 6x15 17-13 3-6 13-9 5-10 32-28 1-5 26-21 7-12 21-17 12-16 30-26 6-11 26-21 4-7 29-26 14-19 21x14 11x18 26-21 16-20 21x14 19-22 27x18 10x19 31-27 19-22 28-23 22x31 23x16 31-27 18-14 27-23 25-21 23-20 17-13 15-19 21-18 19-22 13-10 22-26 10x1 26-30 1-5 30-27 5-10 27-22 10-13 22-19 14-10 19-15 10-5 20-23 5-1 23-20 1-5 7-11 5-10 15-12 10-6 11-15 6-11'.split()
    play_game(italian_moves, 'italian')
    # Turkish
    turkish_moves = ['e3-e4', 'f6-f5', 'b3-b4', 'f5-g5', 'f3-f4', 'a6-a5', 'a3-a4', 'a5xa1', 'b4-a4', 'a1xa6', 'e4-e5', 'e6xg4', 'c3-b3', 'a6-a3', 'd3-d4', 'a3xe1', 'd2-d3', 'e1-f1', 'd4-e4']
    play_game(turkish_moves, 'turkish')
